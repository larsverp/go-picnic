package picnic

import (
	"testing"
)

// Describe the test
func TestToProducts(t *testing.T) {
	jsonresponse := `[{"type":"CATEGORY","id":"aardappel","links":[{"type":"SEARCH","href":"https://storefront-prod.nl.picnicinternational.com/api/15/search?search_term=aardappel"}],"name":"aardappel","items":[{"type":"SINGLE_ARTICLE","id":"11296552","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Mini krieltjes fijn","display_price":78,"price":78,"image_id":"9320effa9f17966b1cbfe7f6ec529d0badc772991b86b04eda94cfb3f0bf7548","max_count":50,"unit_quantity":"450 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074399","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Aardappelpartjes met schil","display_price":119,"price":119,"image_id":"389a7046692c68062f8499c443aa85703c8b3b753af0883d4752316582889825","max_count":50,"unit_quantity":"450 gram","unit_quantity_sub":"€2.64/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11463862","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"400 gram"}],"name":"Zoete aardappelblokjes","display_price":277,"price":277,"image_id":"36bfb0c61e11118d13ca45191e831e5609ac69db6c34ea94f8a5c6e97deffa23","max_count":50,"unit_quantity":"400 gram","unit_quantity_sub":"€6.93/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006101","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Kruimige aardappelen","display_price":199,"price":199,"image_id":"8095f3f65aae5cbc9e1e19890d81a15d7d5f93e8c8737171090373efa7369c79","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€1.99/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11296532","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Kruimige aardappelen","display_price":100,"price":100,"image_id":"50c49366dde12750fe50e39394c416e6fbe68a43936b714887b2f3da0197c08e","max_count":50,"unit_quantity":"450 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"11409528","decorators":[{"type":"FRESH_LABEL","period":"P3D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"425 gram"}],"name":"Aardappelpartjes Roseval","display_price":239,"price":239,"image_id":"b373a2b04e9202524ae658e4d142ff99b75435c3569654c4a2e3d75b55bd85e4","max_count":50,"unit_quantity":"425 gram","unit_quantity_sub":"€5.62/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074779","decorators":[{"type":"FRESH_LABEL","period":"P3D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Aardappelpartjes gekruid","display_price":109,"price":109,"image_id":"985db77caebfa6d761c506ce1a32061f5ae2e81fef76919594bb64876f63dd4d","max_count":50,"unit_quantity":"450 gram","unit_quantity_sub":"€2.42/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006102","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Vastkokende aardappelen","display_price":169,"price":169,"image_id":"6db55a2422534c5d624bbfb019103bb27269f34acc5ac66f96bc161b8a5a3512","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€1.69/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11296537","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Mini krieltjes met bistro kruiden","display_price":89,"price":89,"image_id":"a5a4e52e04428c117c00faf2b22239f38fff5126c2806832273a8c3f10ac54cb","max_count":50,"unit_quantity":"450 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006104","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Zoete aardappelen","display_price":349,"price":349,"image_id":"d53f50c334996ba8730916010cbff7f3673128fc3fd8f7ff184a5a135207aa09","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€3.49/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074669","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Aardappelschijfjes","display_price":68,"price":68,"image_id":"77852f33ec5410c57d03a593bcc611d1c633aa71465045f24bf4580df601b927","max_count":50,"unit_quantity":"450 gram","unit_quantity_sub":"€1.51/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074776","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"800 gram"}],"name":"Kruimige aardappelen","display_price":134,"price":134,"image_id":"3489e897393f023b88fbdd843bbae2f23056214ee3b26230aa9d9e2ab71f1960","max_count":50,"unit_quantity":"800 gram","unit_quantity_sub":"€1.68/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11409534","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"600 gram"}],"name":"Opbakaardappelen","display_price":149,"price":149,"image_id":"8fe90c9a19f85b3c6c325af9bc075c51738a594cbf670f30fb439d9959bdcc50","max_count":50,"unit_quantity":"600 gram","unit_quantity_sub":"€2.49/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006075","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"5 kilo"}],"name":"Kruimige aardappelen","display_price":489,"price":489,"image_id":"26b04da7953251f722c11b6641c8905cc5243088e4db1b152cc4b1576220be64","max_count":50,"unit_quantity":"5 kilo","unit_quantity_sub":"€0.98/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074789","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Aardappelgratin met kaas","display_price":194,"price":194,"image_id":"79b7f4d79b3ac5c674c743af288427efda6f04a0dc537df141e2f5fd8ff10c4f","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€3.88/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006099","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Kriel aardappelen","display_price":140,"price":140,"image_id":"33e0affd2e224f37a4f7fd526a2002544cb709608b774a12f3ba3f7520c35de7","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€2.80/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074660","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"600 gram"}],"name":"Aardappelschijfjes","display_price":79,"price":79,"image_id":"d2419ad9e26ba9e38e5c920164a59696af67cafa5f3417af6e1dbdda251e8aa4","max_count":50,"unit_quantity":"600 gram","unit_quantity_sub":"€1.32/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006140","decorators":[{"type":"FRESH_LABEL","period":"P3D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"750 gram"}],"name":"De rouge aardappelen","display_price":259,"price":259,"image_id":"b4cedcaaa0f587128c09959ad953175450e1ab2d0c3142b839cda02a87ff79e0","max_count":50,"unit_quantity":"750 gram","unit_quantity_sub":"€3.44/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11296546","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"200 gram"}],"name":"Mini krieltjes fijn","display_price":59,"price":59,"image_id":"18f76dfea22c3b84db1b2fea52a0678b31991285f846543e2299a09b87838ce3","max_count":50,"unit_quantity":"200 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"11324517","decorators":[{"type":"FRESH_LABEL","period":"P2D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Aardappelschijfjes met spek en ui","display_price":165,"price":165,"image_id":"ed282a641f67469a566a3a6941b386215e42047329a87c35264899de059dced6","max_count":50,"unit_quantity":"450 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074665","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"600 gram"}],"name":"Mini krieltjes fijn","display_price":88,"price":88,"image_id":"b585db62589e4cffbd69b7739a810f2d7052c17994d07d5a3e4ad574bde3d714","max_count":50,"unit_quantity":"600 gram","unit_quantity_sub":"€1.47/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074780","decorators":[{"type":"FRESH_LABEL","period":"P5D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Aardappelgratin bieslook","display_price":209,"price":209,"image_id":"2d4ef51aef3d9d31db9b9eebc4c4a3018e09f602216d413472004b4c0bae3466","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€4.18/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006143","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Rode aardappelen","display_price":199,"price":199,"image_id":"4df0a2c1561e8d5070351292f2e6d8747864c0c2464a1060b442b79e7958257a","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€1.99/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074728","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Pofaardappelen","display_price":199,"price":199,"image_id":"97a34da8e7e9d35ef05e59edf049258829ba9dd8cee01f5e983167f7ce6c2e05","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€3.98/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074666","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"600 gram"}],"name":"Mini krieltjes met bistro kruiden","display_price":105,"price":105,"image_id":"229abf8e485909fe15301e606955b4506595922abf8c2c3b337b5f7110bc37b2","max_count":50,"unit_quantity":"600 gram","unit_quantity_sub":"€1.75/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074777","decorators":[{"type":"FRESH_LABEL","period":"P3D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"800 gram"}],"name":"Vastkokende aardappelen","display_price":125,"price":125,"image_id":"aed6fcfaf02f0f7d0f3c591e878a4ac9af335646ca65b82e1d312023391e9d54","max_count":50,"unit_quantity":"800 gram","unit_quantity_sub":"€1.56/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006125","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Aardappelpuree","display_price":139,"price":139,"image_id":"66b62d023e12737996563b62cc0ea380b43565a450f184879b7aed13cb0a9a95","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€2.78/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11296555","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"200 gram"}],"name":"Aardappelschijfjes","display_price":59,"price":59,"image_id":"17fa2f0e0d8a8939b7b70581476c87e0278622c0d0383a8a8b8a58cfd1d29977","max_count":50,"unit_quantity":"200 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"11468394","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"400 gram"}],"name":"Bio puree broccoli & bloemkool","display_price":379,"price":379,"image_id":"9f32742f8934038579f08c95a8a96b5c1b2c895b4a91999981d897e5d0a0ca2f","max_count":50,"unit_quantity":"400 gram","unit_quantity_sub":"€9.48/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11409531","decorators":[{"type":"FRESH_LABEL","period":"P3D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"450 gram"}],"name":"Aardappelschijfjes met schil","display_price":139,"price":139,"image_id":"47522e820231fd9e1844901cee92b8b850dedbbdd0129655aa126b6cf3a494de","max_count":50,"unit_quantity":"450 gram","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006106","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"2,5 kilo"}],"name":"Kruimige aardappelen","display_price":325,"price":325,"image_id":"8db2dbd2f82f49c0c4221a1ab7d7beac7e67deebcdc65cbd33645a1863d33d42","max_count":50,"unit_quantity":"2,5 kilo","unit_quantity_sub":"€1.30/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11383203","decorators":[{"type":"FRESH_LABEL","period":"P5D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"500 gram"}],"name":"Kruimige aardappelen","display_price":119,"price":119,"image_id":"4f3b721a803c53eb1052d39de5107bdad616cb2a5fc983bdf4072336119849c9","max_count":50,"unit_quantity":"500 gram","unit_quantity_sub":"€2.38/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"10074662","decorators":[{"type":"FRESH_LABEL","period":"P4D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"600 gram"}],"name":"Hollandse krieltjes","display_price":95,"price":95,"image_id":"eafabf44b331efccb5cc95c1c509c035a1598099643f8ba22f5d9b1b09f035f1","max_count":50,"unit_quantity":"600 gram","unit_quantity_sub":"€1.59/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006118","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"2,5 kilo"}],"name":"Vastkokende aardappelen","display_price":335,"price":335,"image_id":"14db95a02294fb988524ea5e7589853716bceece12b9c8258d3dbebdede9bee6","max_count":50,"unit_quantity":"2,5 kilo","unit_quantity_sub":"€1.34/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"11297601","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"2 kilo"}],"name":"Bio+ kruimige aardappelen","display_price":299,"price":299,"image_id":"dd991bc9f03b2bf7b33cfbf0599086dbbc18fd244e198307f04cd18a2c17ac07","max_count":50,"unit_quantity":"2 kilo","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006108","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Bio+ vastkokende aardappelen","display_price":189,"price":189,"image_id":"da2362f96818e3b109e76ad2491e77c543c010f00cfa928698256a519175e5e3","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€1.89/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006107","decorators":[{"type":"UNIT_QUANTITY","unit_quantity_text":"1 kilo"}],"name":"Bio+ kruimige aardappelen","display_price":179,"price":179,"image_id":"f1063d76d5141234a15367d21a36b592f36a83d3639fffbd85144a6495f86211","max_count":50,"unit_quantity":"1 kilo","unit_quantity_sub":"€1.79/kg","tags":[]},{"type":"SINGLE_ARTICLE","id":"90006070","decorators":[{"type":"FRESH_LABEL","period":"P6D"},{"type":"UNIT_QUANTITY","unit_quantity_text":"5 kilo"}],"name":"Kruimige aardappelen","display_price":519,"price":519,"image_id":"b37b16d2514230c7d689197595d08c92ebc7e2e292e9ea06da2b413244926a97","max_count":50,"unit_quantity":"5 kilo","unit_quantity_sub":"€1.04/kg","tags":[]},{"type":"ITEM_SUGGESTION_DIALOG","id":"item_suggestion_dialog"}],"level":1,"is_included_in_category_tree":false,"hidden":false}]`

	result, err := toProducts([]byte(jsonresponse))
	if err != nil {
		t.Errorf("Error: %s", err)
	}
	if len(result) != 39 {
		t.Errorf("Expected 39 products, got %d", len(result))
	}
}
